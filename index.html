<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Arrow Tune Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Offline arrow tuning calculator – FOC, velocity, KE, game readiness and more.">
<link href="https://rsms.me/inter/inter.css" rel="stylesheet">
<style>
  :root {
    --bg:#f8fafc; --card:#ffffff; --text:#1e293b; --light:#64748b; --border:#e2e8f0;
    --primary:#0ea5e9; --success:#22c55e; --warning:#f59e0b; --danger:#ef4444; --purple:#8b5cf6;
  }
  .dark {
    --bg:#0f172a; --card:#020617; --text:#e2e8f0; --light:#94a3b8; --border:#1e293b;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family:'Inter',sans-serif;
    background:var(--bg);
    color:var(--text);
    padding:0.75rem;
    min-height:100vh;
    line-height:1.4;
  }
  .container {
    max-width:1400px;
    margin:auto;
    display:grid;
    gap:1rem;
  }
  @media (min-width:1024px) {
    .container { grid-template-columns: 1fr 480px; }
  }
  .card {
    background:var(--card);
    border:1px solid var(--border);
    border-radius:14px;
    padding:1.25rem;
    box-shadow:0 10px 30px rgba(15,23,42,0.12);
  }
  .card-header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:1rem;
    flex-wrap:wrap;
    gap:0.5rem;
  }
  h1 { font-size:1.5rem; margin:0; }
  h2 { font-size:1.25rem; margin:0 0 0.75rem 0; }
  label {
    display:block;
    margin:0.75rem 0 0.35rem;
    font-weight:600;
    font-size:0.95rem;
  }
  input, select {
    width:100%;
    padding:0.65rem;
    border:1px solid var(--border);
    border-radius:8px;
    background:var(--card);
    color:var(--text);
    font-size:1rem;
  }
  button {
    padding:0.55rem 1rem;
    border:none;
    border-radius:999px;
    background:var(--primary);
    color:white;
    font-weight:600;
    cursor:pointer;
  }
  .btn-small { padding:0.4rem 0.8rem; font-size:0.9rem; }
  .secondary { background:transparent; color:var(--primary); border:1px solid var(--primary); }
  .flex { display:flex; gap:0.75rem; align-items:center; flex-wrap:wrap; }
  .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:0.75rem; }
  @media (max-width:640px) { .grid-2 { grid-template-columns:1fr; } }
  .toggle-switch { position:relative; display:inline-block; width:56px; height:30px; }
  .toggle-switch input { opacity:0; width:0; height:0; }
  .slider { position:absolute; cursor:pointer; inset:0; background:#cbd5e1; border-radius:34px; transition:.3s; }
  .slider:before { position:absolute; content:""; height:24px; width:24px; left:3px; bottom:3px; background:white; border-radius:50%; transition:.3s; }
  input:checked + .slider { background:var(--primary); }
  input:checked + .slider:before { transform:translateX(26px); }

  .bar {
    height:10px;
    border-radius:999px;
    background:var(--border);
    overflow:hidden;
    margin:0.5rem 0;
  }
  .bar-fill {
    height:100%;
    background:var(--success);
    width:0%;
    transition:width 0.4s ease;
  }
  .dashboard-grid {
    display:grid;
    gap:0.75rem;
    grid-template-columns:repeat(auto-fit, minmax(140px,1fr));
    margin-top:0.5rem;
  }
  .dash-tile {
    background:var(--card);
    border:1px solid var(--border);
    border-radius:12px;
    padding:0.9rem;
    text-align:center;
  }
  .dash-value {
    font-size:1.8rem;
    font-weight:800;
    margin:0.25rem 0;
  }
  .dash-label { font-size:0.85rem; color:var(--light); }
  .game-table {
    width:100%;
    border-collapse:collapse;
    font-size:0.95rem;
  }
  .game-table th, .game-table td {
    padding:0.5rem;
    text-align:left;
    border-bottom:1px solid var(--border);
  }
  .send { color:var(--success); font-weight:700; }
  .marginal { color:var(--warning); font-weight:700; }
  .no { color:var(--danger); font-weight:700; }
</style>
</head>
<body>

<div class="container">

  <!-- LEFT COLUMN – INPUTS -->
  <div>

    <!-- Header -->
    <div class="card">
      <div class="card-header">
        <h1>Arrow Tune Calculator</h1>
        <div class="flex">
          <span style="color:var(--light);">Light</span>
          <label class="toggle-switch">
            <input type="checkbox" id="darkModeToggle"><span class="slider"></span>
          </label>
          <span style="color:var(--light);">Dark</span>
          <button id="openAiModal" class="btn-small" style="background:var(--purple); display:none;">AI Advisor</button>
        </div>
      </div>
      <p style="color:var(--light); font-size:0.95rem;">
        Version 3.0 • Offline • Live calculations
      </p>
    </div>

    <!-- Your Setups -->
    <div class="card">
      <h2>Your Setups</h2>
      <label>Build Name</label>
      <div class="flex">
        <input type="text" id="buildName" placeholder="e.g. 2025 Hoyt RX-9 70# Elk">
        <button class="btn-small secondary" id="suggestName">Suggest</button>
      </div>
      <div class="flex" style="margin-top:0.75rem;">
        <button id="saveBuild">Save</button>
        <select id="loadBuildSelect" style="flex:1;"><option>– Load Build –</option></select>
        <button style="background:var(--danger);" id="deleteBuild">Delete</button>
      </div>
    </div>

    <!-- Bow Setup -->
    <div class="card">
      <h2>Bow Setup</h2>
      <div class="grid-2">
        <div>
          <label>Application</label>
          <select id="application">
            <option>Target / 3D</option>
            <option selected>Hunting</option>
            <option>Other</option>
          </select>
        </div>
        <div>
          <label>Bow Model</label>
          <input type="text" id="bowModel" placeholder="Hoyt RX-9, Mathews Lift...">
        </div>
        <div>
          <label>IBO/ATA Speed (fps)</label>
          <input type="number" id="iboRating" value="340">
        </div>
        <div>
          <label>Draw Weight (lbs)</label>
          <input type="number" id="drawWeight" value="70" step="0.5">
        </div>
        <div>
          <label>Draw Length (in)</label>
          <input type="number" id="drawLength" value="29" step="0.1">
        </div>
        <div>
          <label>String Add-ons (gr)</label>
          <input type="number" id="stringWeightSimple" value="20" step="1">
        </div>
      </div>
    </div>

    >

    <!-- Arrow Setup -->
    <div class="card">
      <h2>Arrow Setup</h2>
      <div class="grid-2">
        <div>
          <label>Arrow Name</label>
          <input type="text" id="arrowName" placeholder="e.g. Victory VAP TKO">
        </div>
        <div>
          <label>Arrow Spine</label>
          <input type="number" id="arrowSpine" value="300">
        </div>
        <div>
          <label>Arrow Length (in)</label>
          <input type="number" id="arrowLength" value="28.5" step="0.1">
        </div>
        <div>
          <label>Total Arrow Weight (gr)</label>
          <input type="number" id="totalArrowWeightSimple" value="495" step="0.5">
        </div>
        <div>
          <label>Point Weight (gr)</label>
          <input type="number" id="pointWeight" value="125" step="1">
        </div>
        <div>
          <label>Balance Point from throat (in)</label>
          <input type="number" id="balancePoint" value="17.2" step="0.05">
        </div>
      </div>
    </div>

  </div>

  <!-- RIGHT COLUMN – LIVE DASHBOARD -->
  <div>

    <!-- Your Settings -->
    <div class="card">
      <h2>Your Settings</h2>
      <div class="grid-2">
        <div>
          <label>Actual FPS (chrono)</label>
          <input type="number" id="actualFPS" placeholder="e.g. 278" step="0.5">
        </div>
        <div>
          <label>Crosswind (mph)</label>
          <input type="number" id="windMph" value="5" step="0.5">
        </div>
      </div>
      <label style="margin-top:0.75rem;">Range (yards)</label>
      <input type="range" id="distanceSlider" min="10" max="100" value="50" style="width:100%;">
      <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:var(--light);">
        <span>10</span><span>30</span><span>50</span><span>70</span><span>100 yd</span>
      </div>
      <div style="text-align:center; margin-top:0.5rem; font-size:1.1rem; font-weight:600;">
        Current range: <span id="distanceValue">50</span> yards
      </div>
    </div>

    <!-- Game Effectiveness (Hunting mode) -->
    <div class="card" id="huntingPanel">
      <h2>Game Effectiveness @ <span id="gameDistance">50</span> yd</h2>
      <table class="game-table">
        <thead><tr><th>Class</th><th>Min KE</th><th>Min Mom.</th><th>Result</th></tr></thead>
        <tbody>
          <tr><td>Small Game</td><td>15 ft-lbs</td><td>0.20</td><td id="smallGame" class="send">Send it</td></tr>
          <tr><td>Deer / Antelope</td><td>25 ft-lbs</td><td>0.30</td><td id="deer" class="send">Send it</td></tr>
          <tr><td>Elk / Large</td><td>42 ft-lbs</td><td>0.44</td><td id="elk" class="send">Send it</td></tr>
          <tr><td>Moose / Tough</td><td>65 ft-lbs</td><td>0.65</td><td id="moose" class="marginal">Marginal</td></tr>
        </tbody>
      </table>
    </div>

    <!-- Live Bars -->
    <div class="card">
      <h2>Live @ Launch → @ <span id="barDistance">50</span> yd</h2>
      <label>Velocity</label>
      <div class="bar"><div class="bar-fill" id="velBar" style="width:88%; background:linear-gradient(to right, var(--success), var(--warning));"></div></div>
      <div style="display:flex; justify-content:space-between; font-size:0.9rem;"><span>278 fps</span><span>245 fps</span></div>

      <label style="margin-top:0.75rem;">Kinetic Energy</label>
      <div class="bar"><div class="bar-fill" id="keBar" style="width:78%; background:linear-gradient(to right, var(--success), var(--warning));"></div></div>
      <div style="display:flex; justify-content:space-between; font-size:0.9rem;"><span>85 ft-lbs</span><span>66 ft-lbs</span></div>

      <label style="margin-top:0.75rem;">Momentum</label>
      <div class="bar"><div class="bar-fill" id="momBar" style="width:90%;"></div></div>
      <div style="display:flex; justify-content:space-between; font-size:0.9rem;"><span>0.59</span><span>0.53 slug·ft/s</span></div>
    </div>

    <!-- Quick Stats Grid -->
    <div class="card">
      <h2>Quick Stats</h2>
      <div class="dashboard-grid">
        <div class="dash-tile">
          <div class="dash-value" id="focValue">15.2</div>
          <div class="dash-label">FOC %</div>
        </div>
        <div class="dash-tile">
          <div class="dash-value" id="gppValue">7.9</div>
          <div class="dash-label">GPP</div>
        </div>
        <div class="dash-tile">
          <div class="dash-value" id="gpiValue">17.4</div>
          <div class="dash-label">GPI</div>
        </div>
        <div class="dash-tile">
          <div class="dash-value" id="driftValue">4.1</div>
          <div class="dash-label">Wind Drift (in)</div>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
// ============ BASIC CALCULATOR (will expand in Phase 2–4) ============
const $ = id => document.getElementById(id);

let isDark = {
  hunting: () => $('application').value !== 'Target / 3D' && $('application').value !== 'Other'
};

function calculateEverything() {
  // Grab values
  const dw = parseFloat($('drawWeight').value) || 70;
  const weight = parseFloat($('totalArrowWeightSimple').value) || 450;
  const point = parseFloat($('pointWeight').value) || 100;
  const len = parseFloat($('arrowLength').value) || 28;
  const balance = parseFloat($('balancePoint').value) || 16;
  const fps = parseFloat($('actualFPS').value) || 278;
  const wind = parseFloat($('windMph').value) || 0;
  const distYd = parseFloat($('distanceSlider').value) || 50;

  // Update displayed distance
  $('distanceValue').textContent = distYd;
  $('gameDistance').textContent = distYd;
  $('barDistance').textContent = distYd;

  // Simple FOC
  const mid = len / 2;
  const foc = ((balance - mid) / len) * 100;
  $('focValue').textContent = foc.toFixed(1);

  // GPP & GPI
  const gpp = weight / dw;
  const gpi = weight / len;
  $('gppValue').textContent = gpp.toFixed(1);
  $('gpiValue').textContent = gpi.toFixed(1);

  // Very simple velocity retention model
  const retention = 0.88 - (gpp - 6) * 0.015; // heavier = better retention
  const velAtDist = fps * retention;
  $('velBar').style.width = (velAtDist / fps * 100).toFixed(1) + '%';

  // KE
  const keLaunch = weight * fps * fps / 450240;
  const keImpact = weight * velAtDist * velAtDist / 450240;
  $('keBar').style.width = (keImpact / keLaunch * 100).toFixed(0) + '%';

  // Momentum
  const momImpact = weight * velAtDist / 225400;
  $('momBar').style.width = (momImpact / (weight * fps / 225400) * 100).toFixed(0) + '%';

  // Game table
  const results = [
    {id:'smallGame', ke:15, mom:0.20},
    {id:'deer', ke:25, mom:0.30},
    {id:'elk', ke:42, mom:0.44},
    {id:'moose', ke:65, mom:0.65}
  ];
  results.forEach(r => {
    const ok = keImpact >= r.ke && momImpact >= r.mom;
    const el = $(r.id);
    el.textContent = ok ? 'Send it' : (keImpact >= r.ke*0.9 || momImpact >= r.mom*0.9) ? 'Marginal' : 'No';
    el.className = ok ? 'send' : (keImpact >= r.ke*0.9 || momImpact >= r.mom*0.9) ? 'marginal' : 'no';
  });

  // Wind drift (super simple)
  const drift = 0.065 * distYd*distYd * wind / weight;
  $('driftValue').textContent = drift.toFixed(1);
}

// Live updates
document.querySelectorAll('input,select').forEach(el => {
  el.addEventListener('input', calculateEverything);
});
$('distanceSlider').addEventListener('input', e => {
  $('distanceValue').textContent = e.target.value;
  calculateEverything();
});

// Dark mode
$('darkModeToggle').addEventListener('change', e => {
  document.body.classList.toggle('dark', e.target.checked);
});

// Run once on load
calculateEverything();
</script>
</body>
</html>